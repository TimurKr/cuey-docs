---
title: "Webhook URLs"
description: "Understanding webhook URL formats and relative URLs"
---

## Overview

Cuey supports two formats for webhook URLs: full URLs and relative URLs. Understanding both formats helps you write cleaner, more maintainable code.

## Full URLs

Full URLs include the complete URL with protocol, domain, and path:

```typescript
await cuey.schedule({
  webhook_url: "https://api.example.com/webhook",
  method: "POST",
  scheduled_at: "2024-12-31T23:59:59Z",
});
```

### When to Use Full URLs

- Different domains per environment
- One-off integrations
- External webhooks

### Example: Different Environments

```typescript
const environment = process.env.NODE_ENV;

const webhookUrl = environment === "production"
  ? "https://api.production.com/webhook"
  : "https://api.staging.com/webhook";

await cuey.schedule({
  webhook_url: webhookUrl,
  method: "POST",
  scheduled_at: "2024-12-31T23:59:59Z",
});
```

## Relative URLs

Relative URLs start with `/` and are resolved against a configured `baseUrl`:

```typescript
const client = new Cuey({
  apiKey: "your-api-key",
  baseUrl: "https://api.example.com",
});

await client.schedule({
  webhook_url: "/webhook", // Resolved to https://api.example.com/webhook
  method: "POST",
  scheduled_at: "2024-12-31T23:59:59Z",
});
```

### When to Use Relative URLs

- Same base domain for all webhooks
- Environment-based configuration
- Cleaner, more maintainable code

### Example: Environment-Based Configuration

```typescript
const client = new Cuey({
  apiKey: process.env.CUEY_API_KEY,
  baseUrl: process.env.API_BASE_URL, // Set per environment
});

// All webhooks use the configured base URL
await client.schedule({
  webhook_url: "/webhooks/notifications",
});

await client.schedule({
  webhook_url: "/webhooks/reports",
});
```

## URL Resolution

### Resolution Order

1. If `webhook_url` starts with `http://` or `https://`, use it as-is
2. If `webhook_url` starts with `/`, resolve against `baseUrl`
3. If `baseUrl` is not configured and URL is relative, throw an error

### Examples

```typescript
const client = new Cuey({
  baseUrl: "https://api.example.com",
});

// Full URL - baseUrl ignored
await client.schedule({
  webhook_url: "https://other-api.com/webhook", // Used as-is
});

// Relative URL - resolved against baseUrl
await client.schedule({
  webhook_url: "/webhook", // Resolved to https://api.example.com/webhook
});

// Relative URL with path
await client.schedule({
  webhook_url: "/api/v1/webhooks/notify", // Resolved to https://api.example.com/api/v1/webhooks/notify
});
```

## Configuration Methods

### Method 1: Constructor Config

```typescript
const client = new Cuey({
  apiKey: "your-api-key",
  baseUrl: "https://api.example.com",
});
```

### Method 2: Environment Variable

```bash
export CUEY_BASE_URL="https://api.example.com"
```

```typescript
import { cuey } from "cuey";

// Uses CUEY_BASE_URL from environment
await cuey.schedule({
  webhook_url: "/webhook",
});
```

### Method 3: Mixed

```typescript
// baseUrl from env, apiKey explicit
const client = new Cuey({
  apiKey: "your-api-key",
  // baseUrl read from CUEY_BASE_URL env var
});
```

## Common Patterns

### Single Base URL

```typescript
const client = new Cuey({
  baseUrl: "https://api.example.com",
});

// All webhooks use same base
await client.schedule({
  webhook_url: "/webhooks/notifications",
});

await client.repeat({
  webhook_url: "/webhooks/reports",
  cron_expression: "0 9 * * *",
});
```

### Multiple Base URLs

```typescript
// Internal API client
const internalClient = new Cuey({
  apiKey: process.env.CUEY_API_KEY,
  baseUrl: "https://internal-api.example.com",
});

// External API client
const externalClient = new Cuey({
  apiKey: process.env.CUEY_API_KEY,
  baseUrl: "https://external-api.example.com",
});

// Use appropriate client
await internalClient.schedule({
  webhook_url: "/internal/webhook",
});

await externalClient.schedule({
  webhook_url: "/external/webhook",
});
```

### Environment-Specific Configuration

```typescript
const getBaseUrl = () => {
  const env = process.env.NODE_ENV;
  switch (env) {
    case "production":
      return "https://api.production.com";
    case "staging":
      return "https://api.staging.com";
    default:
      return "http://localhost:3000";
  }
};

const client = new Cuey({
  apiKey: process.env.CUEY_API_KEY,
  baseUrl: getBaseUrl(),
});

// Webhooks work in all environments
await client.schedule({
  webhook_url: "/webhook", // Automatically uses correct base URL
});
```

## Best Practices

### Use Relative URLs with baseUrl

```typescript
// ✅ Good: Clean and maintainable
const client = new Cuey({
  baseUrl: "https://api.example.com",
});

await client.schedule({
  webhook_url: "/webhook",
});

// ❌ Avoid: Hardcoded full URLs when baseUrl is available
await client.schedule({
  webhook_url: "https://api.example.com/webhook", // Redundant
});
```

### Store baseUrl in Environment Variables

```bash
# .env
API_BASE_URL=https://api.example.com
CUEY_API_KEY=your-api-key
```

```typescript
const client = new Cuey({
  apiKey: process.env.CUEY_API_KEY,
  baseUrl: process.env.API_BASE_URL,
});
```

### Validate URLs

```typescript
function validateWebhookUrl(url: string, baseUrl?: string): string {
  // Full URL
  if (url.startsWith("http://") || url.startsWith("https://")) {
    return url;
  }
  
  // Relative URL requires baseUrl
  if (url.startsWith("/")) {
    if (!baseUrl) {
      throw new Error("Relative URL requires baseUrl configuration");
    }
    return `${baseUrl}${url}`;
  }
  
  throw new Error("Invalid webhook URL format");
}
```

## Error Handling

### Missing baseUrl for Relative URL

```typescript
try {
  const client = new Cuey({
    apiKey: "your-api-key",
    // No baseUrl configured
  });
  
  await client.schedule({
    webhook_url: "/webhook", // Error: relative URL requires baseUrl
  });
} catch (error) {
  // Handle error
}
```

### Invalid URL Format

```typescript
try {
  await cuey.schedule({
    webhook_url: "invalid-url", // Not a valid URL
    scheduled_at: "2024-12-31T23:59:59Z",
  });
} catch (error) {
  if (error instanceof ValidationError) {
    // Handle validation error
  }
}
```

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Configuration"
    icon="gear"
    href="/typescript-client/configuration"
  >
    Learn more about client configuration.
  </Card>
  <Card
    title="Common Use Cases"
    icon="lightbulb"
    href="/guides/common-use-cases"
  >
    See webhook URLs in practice.
  </Card>
</CardGroup>

