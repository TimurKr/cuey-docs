---
title: "Retry Configuration"
description: "Configure retry logic for failed webhook deliveries"
---

## Overview

Cuey automatically retries failed webhook deliveries with configurable retry logic. You can customize the number of retries, backoff delay, and backoff strategy.

## RetryConfig

```typescript
interface RetryConfig {
  maxRetries: number;                  // Maximum retry attempts (1-10)
  backoffMs: number;                   // Backoff delay in milliseconds (100-5000)
  backoffType: "exponential" | "linear"; // Backoff strategy
}
```

## Retry Behavior

When a webhook fails (non-2xx status code or network error):

1. A new retry event is created
2. The retry event inherits the original event's configuration
3. The retry event is scheduled with the configured backoff delay
4. The process repeats until `maxRetries` is reached or the webhook succeeds

## Backoff Strategies

### Exponential Backoff

The delay increases exponentially with each retry:

```
Retry 1: backoffMs * 2^0 = backoffMs
Retry 2: backoffMs * 2^1 = backoffMs * 2
Retry 3: backoffMs * 2^2 = backoffMs * 4
```

**Example:**

```typescript
{
  maxRetries: 3,
  backoffMs: 1000,
  backoffType: "exponential"
}
```

This results in:
- Retry 1: 1 second delay
- Retry 2: 2 seconds delay
- Retry 3: 4 seconds delay

### Linear Backoff

The delay remains constant for each retry:

```
Retry 1: backoffMs
Retry 2: backoffMs
Retry 3: backoffMs
```

**Example:**

```typescript
{
  maxRetries: 3,
  backoffMs: 2000,
  backoffType: "linear"
}
```

This results in:
- Retry 1: 2 seconds delay
- Retry 2: 2 seconds delay
- Retry 3: 2 seconds delay

## Configuration Examples

### Default Configuration

If you don't specify `retry_config`, Cuey uses these defaults:

```typescript
{
  maxRetries: 3,
  backoffMs: 500,
  backoffType: "exponential"
}
```

### Quick Retries (Transient Errors)

For transient errors that resolve quickly:

```typescript
await cuey.schedule({
  webhook_url: "https://api.example.com/webhook",
  scheduled_at: "2024-12-31T23:59:59Z",
  retry_config: {
    maxRetries: 5,
    backoffMs: 500,
    backoffType: "exponential",
  },
});
```

### Aggressive Retries (Critical Operations)

For critical operations that must succeed:

```typescript
await cuey.schedule({
  webhook_url: "https://api.example.com/critical-webhook",
  scheduled_at: "2024-12-31T23:59:59Z",
  retry_config: {
    maxRetries: 10,
    backoffMs: 1000,
    backoffType: "exponential",
  },
});
```

### Slow Retries (Rate-Limited APIs)

For APIs that may be rate-limited:

```typescript
await cuey.schedule({
  webhook_url: "https://api.example.com/webhook",
  scheduled_at: "2024-12-31T23:59:59Z",
  retry_config: {
    maxRetries: 3,
    backoffMs: 5000, // 5 seconds
    backoffType: "linear",
  },
});
```

### No Retries

To disable retries, set `maxRetries` to 1:

```typescript
await cuey.schedule({
  webhook_url: "https://api.example.com/webhook",
  scheduled_at: "2024-12-31T23:59:59Z",
  retry_config: {
    maxRetries: 1,
    backoffMs: 1000,
    backoffType: "linear",
  },
});
```

## Retry Event Tracking

Retry events are linked to the original event via the `retry_of` field:

```typescript
const event = await cuey.events.get("original-event-id");

// If this event failed and was retried
if (event.status === "failed") {
  // Find retry events
  const { data: retries } = await cuey.events.list({
    // Filter by retry_of (if API supports it)
  });
}
```

## Best Practices

### Choose Appropriate maxRetries

```typescript
// ✅ Good: Reasonable retry count
retry_config: {
  maxRetries: 3, // Most errors resolve in 3 attempts
  backoffMs: 1000,
  backoffType: "exponential",
}

// ❌ Avoid: Too many retries for permanent failures
retry_config: {
  maxRetries: 10, // May waste resources on permanent failures
  backoffMs: 1000,
  backoffType: "exponential",
}
```

### Use Exponential Backoff for Most Cases

```typescript
// ✅ Good: Exponential backoff (default)
retry_config: {
  maxRetries: 3,
  backoffMs: 1000,
  backoffType: "exponential", // Reduces load on failing endpoints
}

// ✅ Good: Linear for specific cases
retry_config: {
  maxRetries: 3,
  backoffMs: 5000,
  backoffType: "linear", // When consistent delay is needed
}
```

### Consider API Rate Limits

```typescript
// For rate-limited APIs, use longer delays
retry_config: {
  maxRetries: 3,
  backoffMs: 5000, // 5 seconds to respect rate limits
  backoffType: "linear",
}
```

### Monitor Retry Patterns

Track retry success rates to optimize configuration:

```typescript
// Get failed events
const { data: failedEvents } = await cuey.events.list({
  status: "failed",
});

// Analyze retry patterns
failedEvents.forEach((event) => {
  console.log(`Event ${event.id} failed after retries`);
  console.log(`Response: ${event.response_status}`);
  console.log(`Error: ${event.response_error}`);
});
```

## Retry Event Lifecycle

1. **Original Event Fails**: Event status changes to `failed`
2. **Retry Event Created**: New event created with `retry_of` pointing to original
3. **Retry Scheduled**: Retry event scheduled with backoff delay
4. **Retry Executed**: Retry event attempts webhook delivery
5. **Success or Next Retry**: If successful, process ends. If failed, create next retry

## Configuration Limits

| Parameter | Minimum | Maximum | Default |
|-----------|---------|---------|---------|
| `maxRetries` | 1 | 10 | 3 |
| `backoffMs` | 100 | 5000 | 500 |

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Events Resource"
    icon="calendar"
    href="/typescript-client/events-resource"
  >
    Learn about managing events and retries.
  </Card>
  <Card
    title="Common Use Cases"
    icon="lightbulb"
    href="/guides/common-use-cases"
  >
    See retry configuration in practice.
  </Card>
</CardGroup>

